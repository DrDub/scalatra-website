<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Scalatra guides | Testing</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">

<!-- Le styles -->
<link href="/scalatra-website/_site/assets/css/bootstrap.css" rel="stylesheet">
<link href="/scalatra-website/_site/assets/css/scalatra.css" rel="stylesheet">
<style>
  body {
    padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
  }
</style>
<link href="/scalatra-website/_site/assets/css/bootstrap-responsive.css" rel="stylesheet">

<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- Le fav and touch icons -->
<link rel="shortcut icon" href="/scalatra-website/_site/assets/ico/favicon.ico">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/scalatra-website/_site/assets/ico/apple-touch-icon-144-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/scalatra-website/_site/assets/ico/apple-touch-icon-114-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/scalatra-website/_site/assets/ico/apple-touch-icon-72-precomposed.png">
<link rel="apple-touch-icon-precomposed" href="/scalatra-website/_site/assets/ico/apple-touch-icon-57-precomposed.png">
  </head>

      <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/scalatra-website/_site/">Scalatra</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li><a href="/scalatra-website/_site/getting-started">Getting started</a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Guides
                <b class="caret"></b>
                </a>
                <ul class="dropdown-menu">
                  <li><a href="/scalatra-website/_site/2.0/guides">Overview</a></li>
                  <li><a href="/scalatra-website/_site/2.0/guides/routes-and-actions.html">Routes &amp; Actions</a></li>
                  <li><a href="/scalatra-website/_site/2.0/guides/views.html">Views</a></li>
                  <li><a href="/scalatra-website/_site/2.0/guides/helpers.html">Helpers</a></li>
                  <li><a href="/scalatra-website/_site/2.0/guides/models.html">Models</a></li>
                  <li><a href="/scalatra-website/_site/2.0/guides/testing.html">Testing</a></li>
                  <li><a href="/scalatra-website/_site/2.0/guides/configuration-deployment.html">Configuration &amp; Deployment</a></li>
                </ul>
              </li>
              <li><a href="/scalatra-website/_site/news">News</a></li>
              <li><a href="/scalatra-website/_site/community">Community</a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                API docs
                <b class="caret"></b>
                </a>
                <ul class="dropdown-menu">
              <li>
                <a href="http://scalatra.org/2.1/api">2.1</a>
              </li>
              <li>
                <a href="http://scalatra.org/2.0/api">2.0</a>
              </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container">

          <div class="page-header">
  <h1>Testing</h1>
</div>


<p>Scalatra includes a test framework for writing the unit tests for your Scalatra
application.  The framework lets you send requests to your app and examine the
response.  All HTTP verbs are supported, as well as request parameters and
session tracking.</p>

<h2>Integrations</h2>

<p>scalatra-test can be used with the test framework of your choosing.  A basic
example from each supported framework is shown below.  You may mix and match if
transitioning from one framework to another; sbt will find and run them all by
default.</p>

<h3><a href="http://scalatest.org/">ScalaTest</a></h3>

<h4>Dependency</h4>

<pre><code>"org.scalatra" %% "scalatra-scalatest" % "2.1.0" % "test"
</code></pre>

<h4>Example</h4>

<p>Extend ScalatraSuite with your preferred Suite implementation.  You get
ShouldMatchers and MustMatchers for free.</p>

<div class="highlight"><pre><code class="scala">  <span class="k">import</span> <span class="nn">org.scalatra.test.scalatest._</span>

  <span class="k">class</span> <span class="nc">MyScalatraServletTests</span> <span class="k">extends</span> <span class="nc">ScalatraSuite</span> <span class="k">with</span> <span class="nc">FunSuite</span> <span class="o">{</span>
    <span class="c1">// `MyScalatraServlet` is your app which extends ScalatraServlet</span>
    <span class="n">addServlet</span><span class="o">(</span><span class="n">classOf</span><span class="o">[</span><span class="kt">MyScalatraServlet</span><span class="o">],</span> <span class="s">&quot;/*&quot;</span><span class="o">)</span>

    <span class="n">test</span><span class="o">(</span><span class="s">&quot;simple get&quot;</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">get</span><span class="o">(</span><span class="s">&quot;/path/to/something&quot;</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">status</span> <span class="n">should</span> <span class="n">equal</span> <span class="o">(</span><span class="mi">200</span><span class="o">)</span>
        <span class="n">body</span> <span class="n">should</span> <span class="n">include</span> <span class="o">(</span><span class="s">&quot;hi!&quot;</span><span class="o">)</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
</code></pre>
</div>


<p>Convenience traits are provided for many Suite implementations:</p>

<ul>
<li>ScalatraSpec</li>
<li>ScalatraFlatSpec</li>
<li>ScalatraFreeSpec</li>
<li>ScalatraWordSpec</li>
<li>ScalatraFunSuite</li>
<li>ScalatraFeatureSpec</li>
<li>ScalatraJUnit3Suite</li>
<li>ScalatraJUnitSuite (JUnit 4)</li>
<li>ScalatraTestNGSuite</li>
</ul>


<h3><a href="http://etorreborre.github.com/specs2/">Specs2</a></h3>

<h4>Dependency</h4>

<pre><code>"org.scalatra" %% "scalatra-specs2" % "2.1.0" % "test"
</code></pre>

<h4>Example</h4>

<p>Specs2 supports two basic styles: Unit and Acceptance.  Both are supported
by scalatra-test.</p>

<h4>Unit testing</h4>

<p>From the <a href="http://etorreborre.github.com/specs2/guide/org.specs2.guide.QuickStart.html">Specs2 QuickStart</a>:</p>

<blockquote><p>unit specifications where the specification text is interleaved with the
specification code. It is generally used to specify a single class.</p></blockquote>

<div class="highlight"><pre><code class="scala">  <span class="k">import</span> <span class="nn">org.scalatra.test.specs2._</span>

  <span class="k">class</span> <span class="nc">HelloWorldMutableServletSpec</span> <span class="k">extends</span> <span class="nc">MutableScalatraSpec</span> <span class="o">{</span>
    <span class="n">addServlet</span><span class="o">(</span><span class="n">classOf</span><span class="o">[</span><span class="kt">HelloWorldServlet</span><span class="o">],</span> <span class="s">&quot;/*&quot;</span><span class="o">)</span>

    <span class="s">&quot;GET / on HelloWorldServlet&quot;</span> <span class="n">should</span> <span class="o">{</span>
      <span class="s">&quot;return status 200&quot;</span> <span class="n">in</span> <span class="o">{</span>
        <span class="n">get</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">status</span> <span class="n">must_==</span> <span class="mi">200</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
</code></pre>
</div>


<h4>Acceptance testing</h4>

<p>From the <a href="http://etorreborre.github.com/specs2/guide/org.specs2.guide.QuickStart.html">Specs2 QuickStart</a>:</p>

<blockquote><p>acceptance specifications where all the specification text stands as one and
the implementation code is elsewhere.  It is generally used for acceptance or
integration scenarios</p></blockquote>

<div class="highlight"><pre><code class="scala">  <span class="k">import</span> <span class="nn">org.scalatra.test.specs2._</span>

  <span class="k">class</span> <span class="nc">HelloWorldServletSpec</span> <span class="k">extends</span> <span class="nc">ScalatraSpec</span> <span class="o">{</span> <span class="k">def</span> <span class="n">is</span> <span class="k">=</span>
    <span class="s">&quot;GET / on HelloWorldServlet&quot;</span>                     <span class="o">^</span>
      <span class="s">&quot;return status 200&quot;</span>                            <span class="o">!</span> <span class="n">getRoot200</span><span class="o">^</span>
                                                     <span class="n">end</span>

    <span class="n">addServlet</span><span class="o">(</span><span class="n">classOf</span><span class="o">[</span><span class="kt">HelloWorldServlet</span><span class="o">],</span> <span class="s">&quot;/*&quot;</span><span class="o">)</span>

    <span class="k">def</span> <span class="n">getRoot200</span> <span class="k">=</span> <span class="n">get</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">status</span> <span class="n">must_==</span> <span class="mi">200</span>
    <span class="o">}</span>
  <span class="o">}</span>
</code></pre>
</div>


<h3><a href="http://code.google.com/p/specs/">Specs</a></h3>

<p>Specs is now in maintenance mode.  The author recommends that new projects
begin with Specs2.</p>

<h4>Dependency</h4>

<pre><code>"org.scalatra" %% "scalatra-specs" % "2.1.0" % "test"
</code></pre>

<h4>Example</h4>

<div class="highlight"><pre><code class="scala">  <span class="k">import</span> <span class="nn">org.scalatra.test.specs._</span>

  <span class="k">object</span> <span class="nc">MyScalatraServletTests</span> <span class="k">extends</span> <span class="nc">ScalatraSpecification</span> <span class="o">{</span>
    <span class="n">addServlet</span><span class="o">(</span><span class="n">classOf</span><span class="o">[</span><span class="kt">MyScalatraServlet</span><span class="o">],</span> <span class="s">&quot;/*&quot;</span><span class="o">)</span>

    <span class="s">&quot;MyScalatraServlet when using GET&quot;</span> <span class="n">should</span> <span class="o">{</span>
      <span class="s">&quot;/path/to/something should return &#39;hi!&#39;&quot;</span> <span class="n">in</span> <span class="o">{</span>
        <span class="n">get</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">status</span> <span class="n">mustEqual</span><span class="o">(</span><span class="mi">200</span><span class="o">)</span>
          <span class="n">body</span> <span class="n">mustEqual</span><span class="o">(</span><span class="s">&quot;hi!&quot;</span><span class="o">)</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
</code></pre>
</div>


<h3>Other test frameworks</h3>

<h4>Dependency</h4>

<pre><code>"org.scalatra" %% "scalatra-test" % "2.1.0" % "test"
</code></pre>

<h4>Usage guide</h4>

<p>Create an instance of <code>org.scalatra.test.ScalatraTests</code>.  Be sure to call
<code>start()</code> and <code>stop()</code> before and after your test suite.</p>

<h3>Maven repository</h3>

<p>To make usage of Scalatra as a dependency convenient, Maven hosting is now
available courtesy of
<a href="https://docs.sonatype.com/display/NX/OSS+Repository+Hosting">Sonatype</a>.</p>

<ul>
<li><a href="https://oss.sonatype.org/content/repositories/releases">Releases</a></li>
<li><a href="https://oss.sonatype.org/content/repositories/snapshots">Snapshots</a></li>
</ul>


<h3>Testing FAQ</h3>

<h4>How do I set a servlet init parameter?</h4>

<p>scalatra-test is built on Jetty's <a href="http://download.eclipse.org/jetty/stable-7/apidocs/org/eclipse/jetty/testing/ServletTester.html">ServletTester</a>, so it
does not read your web.xml.  Most things you can do in a web.xml can be
done from the context on the tester object.  In this case, call this in
the constructor of your servlet:</p>

<pre><code>tester.getContext.setInitParameter("db.username", "ross")
</code></pre>

<h4>How do I test file uploads?</h4>

<p>Convenience methods exist for testing file uploads.</p>

<p>Example based on Specs2:</p>

<div class="highlight"><pre><code class="scala">  <span class="k">class</span> <span class="nc">FileUploadSpec</span> <span class="k">extends</span> <span class="nc">MutableScalatraSpec</span> <span class="o">{</span>
    <span class="n">addServlet</span><span class="o">(</span><span class="n">classOf</span><span class="o">[</span><span class="kt">FileUploadServlet</span><span class="o">],</span> <span class="s">&quot;/*&quot;</span><span class="o">)</span>

    <span class="s">&quot;POST /files&quot;</span> <span class="n">should</span> <span class="o">{</span>
      <span class="s">&quot;return status 200&quot;</span> <span class="n">in</span> <span class="o">{</span>
        <span class="c1">// You can also pass headers after the files Map</span>
        <span class="n">post</span><span class="o">(</span><span class="s">&quot;/files&quot;</span><span class="o">,</span> <span class="nc">Map</span><span class="o">(</span><span class="s">&quot;private&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;true&quot;</span><span class="o">),</span> <span class="nc">Map</span><span class="o">(</span><span class="s">&quot;kitten&quot;</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">&quot;kitten.png&quot;</span><span class="o">)))</span> <span class="o">{</span>
          <span class="n">status</span> <span class="n">must_==</span> <span class="mi">200</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>

    <span class="s">&quot;PUT /files/:id&quot;</span> <span class="n">should</span> <span class="o">{</span>
      <span class="s">&quot;return status 200&quot;</span> <span class="n">in</span> <span class="o">{</span>
        <span class="n">put</span><span class="o">(</span><span class="s">&quot;/files/10&quot;</span><span class="o">,</span> <span class="nc">Map</span><span class="o">(</span><span class="s">&quot;private&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;false&quot;</span><span class="o">),</span> <span class="nc">Map</span><span class="o">(</span><span class="s">&quot;kitten&quot;</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">&quot;kitten.png&quot;</span><span class="o">)))</span> <span class="o">{</span>
          <span class="n">status</span> <span class="n">must_==</span> <span class="mi">200</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
</code></pre>
</div>





      </div> <!-- /container -->

  <!-- Le javascript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="/scalatra-website/_site/assets/js/jquery.min.js"></script>
  <script src="/scalatra-website/_site/assets/js/bootstrap.min.js"></script>
</body>

</html>