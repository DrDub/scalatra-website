<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Scalatra Guides | Helpers</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">

<!-- Le styles -->
<link href="../assets/css/bootstrap.css" rel="stylesheet">
<link href="../assets/css/scalatra.css" rel="stylesheet">
<style>
  body {
    padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
  }
</style>
<link href="../assets/css/bootstrap-responsive.css" rel="stylesheet">

<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- Le fav and touch icons -->
<link rel="shortcut icon" href="/assets/ico/favicon.ico">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
<link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">
  </head>

      <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/">Scalatra</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li><a href="/getting-started">Getting started</a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Guides
                <b class="caret"></b>
                </a>
                <ul class="dropdown-menu">
                  <li><a href="/guides">Overview</a></li>
                  <li><a href="/guides/routes-and-actions.html">Routes &amp; Actions</a></li>
                  <li><a href="/guides/views.html">Views</a></li>
                  <li><a href="/guides/helpers.html">Helpers</a></li>
                  <li><a href="/guides/models.html">Models</a></li>
                  <li><a href="/guides/testing.html">Testing</a></li>
                  <li><a href="/guides/configuration-deployment.html">Configuration &amp; Deployment</a></li>
                </ul>
              </li>
              <li><a href="/news">News</a></li>
              <li><a href="/community">Community</a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                API docs
                <b class="caret"></b>
                </a>
                <ul class="dropdown-menu">
              <li>
                <a href="/2.1/api">2.1</a>
              </li>
              <li>
                <a href="/2.0/api">2.0</a>
              </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container">

          <div class="page-header">
<h1>Helpers</h1>
</div>


<p>Helpers exist as traits in Scalatra that can applied to your base class.</p>

<h2>Request</h2>

<p>Inside any action, the current request is available through the <code>request</code> variable.
The underlying servlet request is implicitly extended with the following methods:</p>

<dl class="dl-horizontal">
<dt>body</dt>
<dd>to get the request body as a string.</dd>
<dt>isAjax</dt>
<dd>to detect AJAX requests.</dd>
<dt>cookies</dt>
<dd>a Map view of the request's cookies.</dd>
<dt>multiCookies</dt>
<dd>a Map view of the request's cookies.</dd>
</dl>


<p>The <code>request</code> also implements a <code>scala.collection.mutable.Map</code> backed by the
request attributes.</p>

<h2>Response</h2>

<p>The response is available through the <code>response</code> variable.</p>

<p><span class="badge badge-warning"><i class="icon-warning-sign icon-white"></i></span>
If you override the Scalatra handling and write directly to
the response object (e.g. <code>response.getOutputStream</code>), then your action should
return <code>Unit()</code> to prevent a conflict with multiple writes.</p>

<h2>Session handling</h2>

<p>Scalatra has session handling built into the framework by default. There are
no modules or traits that you need to include.</p>

<p><span class="badge badge-info"><i class="icon-flag icon-white"></i></span>
Sessions are <em>off</em> until the <code>session</code> method is called.
Once <code>session</code> is called, a cookie-based session will be created.</p>

<p>Then you will be able to use the default cookie based session handler in your
application:</p>

<div class="highlight"><pre><code class="scala">  <span class="n">get</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span><span class="o">(</span><span class="n">session</span><span class="o">.</span><span class="n">contains</span><span class="o">(</span><span class="s">&quot;counter&quot;</span><span class="o">))</span> <span class="n">session</span><span class="o">(</span><span class="s">&quot;counter&quot;</span><span class="o">)</span> <span class="k">=</span> <span class="mi">0</span>
    <span class="n">session</span><span class="o">(</span><span class="s">&quot;counter&quot;</span><span class="o">)</span> <span class="k">=</span> <span class="n">session</span><span class="o">(</span><span class="s">&quot;counter&quot;</span><span class="o">).</span><span class="n">toInt</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="s">&quot;You&#39;ve hit this page %s times!&quot;</span> <span class="n">format</span> <span class="n">session</span><span class="o">(</span><span class="s">&quot;counter&quot;</span><span class="o">).</span><span class="n">toInt</span>
  <span class="o">}</span>
</code></pre>
</div>


<p>The <code>session</code> implicitly implements <code>scala.collection.mutable.Map</code> backed by
<code>session</code> attributes.</p>

<p><span class="badge badge-success"><i class="icon-thumbs-up icon-white"></i></span>
There's also a <code>sessionOption</code> method, which returns a <code>session</code> if one already
exists, and <code>None</code> if it doesn't. This is a good way to avoid creating a
<code>session</code>. If you don't need a <code>session</code> in your application, e.g. if you're
building out a stateless RESTFul API, never call the <code>session</code> method, and
don't mix in <code>FlashMapSupport</code> (which also creates a session).</p>

<p><span class="badge badge-warning"><i class="icon-warning-sign icon-white"></i></span>
The default session in Scalatra is cookie-based, but the cookie is used only
as a session identifier (session data is stored server-side). If you are
building out a shared-nothing architecture, this is something to be aware of.</p>

<h2>ServletContext</h2>

<p>The servlet context is available through the <code>servletContext</code> variable.  The
servlet context implicitly implements <code>scala.collection.mutable.Map</code> backed
by servlet context attributes.</p>

<h2>Scalate error page</h2>

<p>Mixing in ScalateSupport enables the Scalate error page for any uncaught
exceptions.  This page renders the template source with the error highlighted.
To disable this behavior, override <code>isScalateErrorPageEnabled</code>:</p>

<div class="highlight"><pre><code class="scala">  <span class="k">override</span> <span class="k">def</span> <span class="n">isScalatePageEnabled</span> <span class="k">=</span> <span class="kc">false</span>
</code></pre>
</div>


<h2>Scentry + authentication</h2>

<p>Scentry is a user submitted authentication scheme. Combined
<code>ScentrySupport</code> and <code>BasicAuthSupport</code> traits allow you to quickly tie a
User class to the session and Basic Authentication methods.</p>

<p>There is a new authentication middleware in the auth directory, to be
documented soon.  See an example at
<a href="http://gist.github.com/660701">usage example</a>.
Another <a href="https://gist.github.com/732347">example</a> for basic authentication
can be found</p>

<h4>Dependency</h4>

<div class="highlight"><pre><code class="scala"><span class="c1">// Put this in build.sbt:</span>
<span class="s">&quot;org.scalatra&quot;</span> <span class="o">%</span> <span class="s">&quot;scalatra-auth&quot;</span> <span class="o">%</span> <span class="s">&quot;2.1.0&quot;</span>
</code></pre>
</div>


<h2>Flash map</h2>

<p>Flash support, allowing you to store information across requests and expire
it immediately after a redirect, is included within Scalatra by default.</p>

<p>Flash entries are not normally available within the current request scope.
The exception is adding new flash entries into <code>flash.now</code>.</p>

<p>In order to enable flash support, you'll need to extend your servlet class
with <code>FlashMapSupport</code>. You can set the flash like this:</p>

<div class="highlight"><pre><code class="scala"><span class="k">class</span> <span class="nc">FooServlet</span> <span class="k">extends</span> <span class="nc">ScalatraServlet</span> <span class="k">with</span> <span class="nc">FlashMapSupport</span> <span class="o">{</span>
 <span class="n">post</span><span class="o">(</span><span class="s">&quot;/articles/create&quot;</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// watch out: this creates a session!</span>
    <span class="n">flash</span><span class="o">(</span><span class="s">&quot;notice&quot;</span><span class="o">)</span> <span class="k">=</span> <span class="s">&quot;article created succesfully&quot;</span>
    <span class="n">redirect</span><span class="o">(</span><span class="s">&quot;/home&quot;</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="n">get</span><span class="o">(</span><span class="s">&quot;/home&quot;</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ssp</span><span class="o">(</span><span class="s">&quot;/home&quot;</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>


<p>and then you can use it in your view, to let the user know what happened.
<code>home.ssp</code> might look like this:</p>

<div class="highlight"><pre><code class="scala"><span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="nc">Here</span> <span class="n">is</span> <span class="n">the</span> <span class="n">flash</span><span class="k">:</span> <span class="k">&lt;%</span><span class="o">=</span> <span class="n">flash</span><span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;notice&quot;</span><span class="o">)</span> <span class="o">%&gt;&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</code></pre>
</div>


<p>You can add more than one entry to the <code>FlashMap</code>, using <code>+=</code>:</p>

<div class="highlight"><pre><code class="scala"><span class="n">flash</span> <span class="k">=</span> <span class="o">(</span><span class="s">&quot;notice&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;Hello from your application&quot;</span><span class="o">)</span>
<span class="n">flash</span> <span class="o">+=</span> <span class="o">(</span><span class="s">&quot;error&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;An error occurred&quot;</span><span class="o">)</span>
<span class="n">flash</span><span class="o">.</span><span class="n">now</span> <span class="o">+=</span> <span class="o">(</span><span class="s">&quot;info&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;redirect to see the error&quot;</span><span class="o">)</span>
</code></pre>
</div>


<p><code>flash.now</code> operates pretty much in the same way as <code>flash</code> does, except that
it sets a value for the current request only.  It will be removed before the
next request unless explicitly kept.</p>

<p>Please note: extending your ScalatraServlet with <code>FlashMapSupport</code> triggers
a session, which is why it's an optional mixin.</p>

<h2>Uploading files</h2>

<p>File upload support is included within Scalatra by default by leveraging
the Servlet 3.0 API's built-in support for <code>multipart/form-data</code> requests.</p>

<ol>
<li>Extend your application with <code>FileUploadSupport</code>:</li>
</ol>


<div class="highlight"><pre><code class="scala">  <span class="k">import</span> <span class="nn">org.scalatra.ScalatraServlet</span>
  <span class="k">import</span> <span class="nn">org.scalatra.servlet.FileUploadSupport</span>
  <span class="k">import</span> <span class="nn">javax.servlet.annotation.MultipartConfig</span>

  <span class="nd">@MultipartConfig</span><span class="o">(</span><span class="n">maxFileSize</span><span class="k">=</span><span class="mi">3</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="o">)</span>
  <span class="k">class</span> <span class="nc">MyApp</span> <span class="k">extends</span> <span class="nc">ScalatraServlet</span> <span class="k">with</span> <span class="nc">FileUploadSupport</span> <span class="o">{</span>
    <span class="c1">// ...</span>
  <span class="o">}</span>
</code></pre>
</div>


<p>If you prefer using your <em>web.xml</em> over the <code>@MultipartConfig</code> annotation, you can also
place <code>&lt;multipart-config&gt;</code> to your <code>&lt;servlet&gt;</code>:</p>

<div class="highlight"><pre><code class="scala"><span class="o">&lt;</span><span class="n">servlet</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">servlet</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span><span class="n">myapp</span><span class="o">&lt;/</span><span class="n">servlet</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">servlet</span><span class="o">-</span><span class="n">class</span><span class="o">&gt;</span><span class="n">com</span><span class="o">.</span><span class="n">me</span><span class="o">.</span><span class="nc">MyApp</span><span class="o">&lt;/</span><span class="n">servlet</span><span class="o">-</span><span class="n">class</span><span class="o">&gt;</span>

  <span class="o">&lt;</span><span class="n">multipart</span><span class="o">-</span><span class="n">config</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">max</span><span class="o">-</span><span class="n">file</span><span class="o">-</span><span class="n">size</span><span class="o">&gt;</span><span class="mi">3145728</span><span class="o">&lt;/</span><span class="n">max</span><span class="o">-</span><span class="n">file</span><span class="o">-</span><span class="n">size</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">multipart</span><span class="o">-</span><span class="n">config</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">servlet</span><span class="o">&gt;</span>
</code></pre>
</div>


<p>See
<a href="http://docs.oracle.com/javaee/6/api/javax/servlet/annotation/MultipartConfig.html">javax.servlet.annotation.MultipartConfig Javadoc</a>
for more details on configurable attributes.</p>

<p><strong>Note for Jetty users</strong>: <code>@MultipartConfig</code> and the <em>web.xml</em> <code>&lt;multipart-config&gt;</code> does not
work correctly in Jetty prior to version 8.1.3.</p>

<ol>
<li>Be sure that your form is of type <code>multipart/form-data</code>:</li>
</ol>


<div class="highlight"><pre><code class="scala">  <span class="n">get</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">&lt;</span><span class="n">form</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;post&quot;</span> <span class="n">enctype</span><span class="o">=</span><span class="s">&quot;multipart/form-data&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;file&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;thefile&quot;</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="o">/&gt;</span>
    <span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>
  <span class="o">}</span>
</code></pre>
</div>


<ol>
<li>Your files are available through the <code>fileParams</code> or <code>fileMultiParams</code> maps:</li>
</ol>


<div class="highlight"><pre><code class="scala">  <span class="n">post</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">processFile</span><span class="o">(</span><span class="n">fileParams</span><span class="o">(</span><span class="s">&quot;thefile&quot;</span><span class="o">))</span>
  <span class="o">}</span>
</code></pre>
</div>


<ol>
<li>To handle the case where user uploads too large file, you can define an error handler:</li>
</ol>


<div class="highlight"><pre><code class="scala">  <span class="n">error</span> <span class="o">{</span>
    <span class="k">case</span> <span class="n">e</span><span class="k">:</span> <span class="kt">SizeConstraintExceededException</span> <span class="o">=&gt;</span> <span class="nc">RequestEntityTooLarge</span><span class="o">(</span><span class="s">&quot;too much!&quot;</span><span class="o">)</span>
  <span class="o">}</span>
</code></pre>
</div>


<p>Scalatra wraps <code>IllegalStateException</code> thrown by <code>HttpServletRequest#getParts()</code> inside
<code>SizeConstraintExceededException</code> for the convenience of use. If the container for some
reason throws other exception than <code>IllegalStateException</code> when it detects a too large file upload
or a too large request in general, or you are getting false positives, you can configure
the wrapping by overriding <code>isSizeConstraintException</code> method.</p>

<p>For example, Jetty 8.1.3 incorrectly throws <code>ServletException</code> instead of <code>IllegalStateException</code>.
You can configure that to be wrapped inside <code>SizeConstraintExceededException</code>s by including the
following snippet to your servlet:</p>

<div class="highlight"><pre><code class="scala">  <span class="k">override</span> <span class="k">def</span> <span class="n">isSizeConstraintException</span><span class="o">(</span><span class="n">e</span><span class="k">:</span> <span class="kt">Exception</span><span class="o">)</span> <span class="k">=</span> <span class="n">e</span> <span class="k">match</span> <span class="o">{</span>
    <span class="k">case</span> <span class="n">se</span><span class="k">:</span> <span class="kt">ServletException</span> <span class="kt">if</span> <span class="kt">se.getMessage.contains</span><span class="o">(</span><span class="err">&quot;</span><span class="kt">exceeds</span> <span class="kt">max</span> <span class="kt">filesize</span><span class="err">&quot;</span><span class="o">)</span> <span class="kt">||</span>
                                 <span class="n">se</span><span class="o">.</span><span class="n">getMessage</span><span class="o">.</span><span class="n">startsWith</span><span class="o">(</span><span class="s">&quot;Request exceeds maxRequestSize&quot;</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="kc">true</span>
    <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="kc">false</span>
  <span class="o">}</span>
</code></pre>
</div>


<h2>Anti-XML integration</h2>

<p>Scalatra provides optional <a href="http://anti-xml.org/">Anti-XML</a> integration:</p>

<h4>Dependency</h4>

<div class="highlight"><pre><code class="scala">  <span class="c1">// Put this in build.sbt:</span>
  <span class="s">&quot;org.scalatra&quot;</span> <span class="o">%</span> <span class="s">&quot;scalatra-anti-xml&quot;</span> <span class="o">%</span> <span class="s">&quot;2.1.0&quot;</span>
</code></pre>
</div>


<p>Extend your application with <code>AntiXmlSupport</code>:</p>

<div class="highlight"><pre><code class="scala"><span class="k">import</span> <span class="nn">org.scalatra.ScalatraServlet</span>
<span class="k">import</span> <span class="nn">org.scalatra.antixml.AntiXmlSupport</span>
<span class="k">import</span> <span class="nn">com.codecommit.antixml._</span>

<span class="k">class</span> <span class="nc">MyApp</span> <span class="k">extends</span> <span class="nc">ScalatraServlet</span> <span class="k">with</span> <span class="nc">AntiXmlSupport</span> <span class="o">{</span>
  <span class="c1">// ...</span>
<span class="o">}</span>
</code></pre>
</div>


<p>Actions results of type <code>com.codecommit.antixml.Elem</code> will be serialized
to the response body, and a content type of <code>text/html</code> will be inferred if
none is set.</p>

<div class="highlight"><pre><code class="scala">  <span class="n">get</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">XML</span><span class="o">.</span><span class="n">fromString</span><span class="o">(</span><span class="s">&quot;&quot;&quot;&lt;foo bar=&quot;baz&quot;&gt;&lt;/foo&gt;&quot;&quot;&quot;</span><span class="o">)</span>
  <span class="o">}</span>
</code></pre>
</div>


<h2>URL support and reverse routes</h2>

<p>UrlSupport provides two instances that provide you with relative URLs.
<code>UrlSupport.url</code> will return a string that can be used in your output or a
redirect statement.</p>

<h3>Page relative url:</h3>

<div class="highlight"><pre><code class="scala">  <span class="n">get</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">){</span>
    <span class="c1">// This will redirect to http://&lt;host&gt;/page-relative</span>
    <span class="n">redirect</span><span class="o">(</span><span class="n">url</span><span class="o">(</span><span class="s">&quot;page-relative&quot;</span><span class="o">))</span>
  <span class="o">}</span>
</code></pre>
</div>


<h3>Context relative url:</h3>

<div class="highlight"><pre><code class="scala">  <span class="n">get</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">){</span>
    <span class="c1">// This will redirect to http://&lt;host&gt;/&lt;context&gt;/context-relative</span>
    <span class="n">redirect</span><span class="o">(</span><span class="n">url</span><span class="o">(</span><span class="s">&quot;/context-relative&quot;</span><span class="o">))</span>
  <span class="o">}</span>
</code></pre>
</div>


<h3>Mapped params:</h3>

<div class="highlight"><pre><code class="scala">  <span class="n">get</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// This will redirect to http://&lt;host&gt;/&lt;context&gt;/en-to-es?one=uno&amp;two=dos</span>
    <span class="n">redirect</span><span class="o">(</span> <span class="n">url</span><span class="o">(</span><span class="s">&quot;/en-to-es&quot;</span><span class="o">,</span> <span class="nc">Map</span><span class="o">(</span><span class="s">&quot;one&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;uno&quot;</span><span class="o">,</span> <span class="s">&quot;two&quot;</span> <span class="o">-&gt;</span> <span class="s">&quot;dos&quot;</span><span class="o">))</span> <span class="o">)</span>
  <span class="o">}</span>
</code></pre>
</div>


<h3>Reverse routes:</h3>

<p>It is possible to save your routes as variables so that they have convenient
handles:</p>

<div class="highlight"><pre><code class="scala">  <span class="k">class</span> <span class="nc">MyApp</span> <span class="k">extends</span> <span class="nc">ScalatraServlet</span> <span class="k">with</span> <span class="nc">UrlGeneratorSupport</span> <span class="o">{</span>
    <span class="c1">// When you create a route, you can save it as a variable</span>
    <span class="k">val</span> <span class="n">viewUser</span> <span class="k">=</span> <span class="n">get</span><span class="o">(</span><span class="s">&quot;/user/:id&quot;</span><span class="o">)</span> <span class="o">{</span>
       <span class="c1">// your user action would go here</span>
     <span class="o">}</span>

    <span class="n">post</span><span class="o">(</span><span class="s">&quot;/user/new&quot;</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// url method provided by UrlGeneratorSupport.  Pass it the route</span>
      <span class="c1">// and the params.</span>
      <span class="n">redirect</span><span class="o">(</span><span class="n">url</span><span class="o">(</span><span class="n">viewUser</span><span class="o">,</span> <span class="s">&quot;id&quot;</span> <span class="o">-&gt;</span> <span class="n">newUser</span><span class="o">.</span><span class="n">id</span><span class="o">))</span>
    <span class="o">}</span>
  <span class="o">}</span>
</code></pre>
</div>


<p>There's also a <code>ScalateUrlGeneratorSupport</code>.  It reflectively finds all
members of your app of type Route (e.g., viewUser above) and makes them
available in your templates.  You should then be able to do something like this
right in your templates:</p>

<div class="highlight"><pre><code class="scala">  <span class="n">url</span><span class="o">(</span><span class="n">viewUser</span><span class="o">,</span> <span class="s">&quot;id&quot;</span> <span class="o">-&gt;</span> <span class="mi">1</span><span class="o">)</span>
</code></pre>
</div>


<h2>AkkaSupport</h2>

<p>Akka is a toolkit and runtime for building highly concurrent, distributed, and
fault tolerant event-driven applications on the JVM. Scalatra allows you to
mix it right into your application.</p>

<h4>Dependency:</h4>

<div class="highlight"><pre><code class="scala"><span class="c1">// Put this in build.sbt:</span>
<span class="s">&quot;io.akka&quot;</span> <span class="o">%</span> <span class="s">&quot;akka&quot;</span> <span class="o">%</span> <span class="s">&quot;2.0.3&quot;</span>
</code></pre>
</div>


<p>Provides a mechanism for adding <a href="http://akka.io/">Akka</a> futures to your routes. Akka support
is only available in Scalatra 2.1 and up.</p>

<div class="highlight"><pre><code class="scala">  <span class="k">import</span> <span class="nn">_root_.akka.dispatch._</span>
  <span class="k">import</span> <span class="nn">org.scalatra.akka.AkkaSupport</span>

  <span class="k">class</span> <span class="nc">MyAppServlet</span> <span class="k">extends</span> <span class="nc">ScalatraServlet</span> <span class="k">with</span> <span class="nc">AkkaSupport</span> <span class="o">{</span>
    <span class="n">get</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">){</span>
      <span class="nc">Future</span> <span class="o">{</span>
        <span class="c1">// Add other logic here</span>

        <span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;</span><span class="nc">Hello</span> <span class="nc">Akka</span><span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
</code></pre>
</div>


<h2>Cross origin resource sharing</h2>

<p>Scalatra allows you to mix in the <code>CorsSupport</code> trait if you need to do
<a href="http://en.wikipedia.org/wiki/Cross-origin_resource_sharing">cross-origin resource sharing</a>.</p>

<p>Adding <code>CorsSupport</code> allows all requests from anywhere, by default. You can
configure your application to be more restrictive by using the following init
params.</p>

<p><code>org.scalatra.cors.allowedOrigins = "http://example.com:8080 http://foo.example.com"</code>
- List the hosts and ports which will be allowed to make cross-origin requests,
separated by spaces (* by default).</p>

<p><code>org.scalatra.cors.allowedMethods = "GET"</code> - List what HTTP methods will be
accepted. Available options are GET, POST, PUT, DELETE, HEAD, OPTIONS, and
PATCH. All hosts are accepted by default.</p>

<p><code>org.scalatra.cors.allowedHeaders = "Content-Type"</code> - Set a list of allowed
HTTP headers, most headers are supported.</p>

<p><code>org.scalatra.cors.preflightMaxAge = 1800</code> - Set the number of seconds that
preflight requests can be cached by the client. Default value is 0 seconds.</p>

<p><code>org.scalatra.cors.allowCredentials = true</code> - By default, cookies are not
included in CORS requests. Set this to <code>true</code> to allow cookies.</p>

<p>If you're not familiar with CORS, you may want to find out a bit more about
<a href="http://www.w3.org/TR/cors/#resource-preflight-requests">preflightMaxAge</a> and <a href="http://www.w3.org/TR/cors/#supports-credentials">allowCredentials</a> or
<a href="http://www.w3.org/TR/cors">read the whole spec</a> at the W3C. A good tutorial is also available
at <a href="http://www.html5rocks.com/en/tutorials/cors/">HTML5Rocks</a>.</p>

<p>Init params can go into either your web.xml file or into your Scalatra
bootstrap config file (src/main/scala/Scalatra.scala). See the
<a href="http://www.scalatra.org/2.1/book/#Mounting_multiple_servlets__or_filters_">Scalatra bootstrap</a> section for further info.</p>


      </div> <!-- /container -->

  <!-- Le javascript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="../assets/js/jquery.min.js"></script>
  <script src="../assets/js/bootstrap.min.js"></script>
</body>

</html>